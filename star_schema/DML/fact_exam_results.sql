INSERT INTO `tcc-tsi.microdados_enem_2022.fact_exam_results` (
    NU_INSCRICAO,
    NU_ANO,
    NU_NOTA_CN,
    NU_NOTA_CH,
    NU_NOTA_LC,
    NU_NOTA_MT,
    NU_NOTA_FINAL_OBJETIVA,
    NU_NOTA_COMP1,
    NU_NOTA_COMP2,
    NU_NOTA_COMP3,
    NU_NOTA_COMP4,
    NU_NOTA_COMP5,
    NU_NOTA_REDACAO
)
SELECT 
    NU_INSCRICAO,
    NU_ANO,
    CAST(NU_NOTA_CN AS FLOAT64) AS NU_NOTA_CN,
    CAST(NU_NOTA_CH AS FLOAT64) AS NU_NOTA_CH,
    CAST(NU_NOTA_LC AS FLOAT64) AS NU_NOTA_LC,
    CAST(NU_NOTA_MT AS FLOAT64) AS NU_NOTA_MT,
    (CAST(NU_NOTA_CN AS FLOAT64) + CAST(NU_NOTA_CH AS FLOAT64) + 
     CAST(NU_NOTA_LC AS FLOAT64) + CAST(NU_NOTA_MT AS FLOAT64)) / 4 AS NU_NOTA_FINAL_OBJETIVA,
    CAST(NU_NOTA_COMP1 AS FLOAT64) AS NU_NOTA_COMP1,
    CAST(NU_NOTA_COMP2 AS FLOAT64) AS NU_NOTA_COMP2,
    CAST(NU_NOTA_COMP3 AS FLOAT64) AS NU_NOTA_COMP3,
    CAST(NU_NOTA_COMP4 AS FLOAT64) AS NU_NOTA_COMP4,
    CAST(NU_NOTA_COMP5 AS FLOAT64) AS NU_NOTA_COMP5,
    CAST(NU_NOTA_REDACAO AS FLOAT64) AS NU_NOTA_REDACAO
FROM 
    `tcc-tsi.microdados_enem_2022.enrich_microdados_enem_2022`;
